# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: hdelacou                                  +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/12/03                              #+#    #+#              #
#    Updated: 2025/12/03                             ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# ============================================================================ #
#                                  COLORS                                      #
# ============================================================================ #

DEF_COLOR	= \033[0;39m
GRAY		= \033[0;90m
RED			= \033[0;91m
GREEN		= \033[0;92m
YELLOW		= \033[0;93m
BLUE		= \033[0;94m
MAGENTA		= \033[0;95m
CYAN		= \033[0;96m
WHITE		= \033[0;97m
BOLD		= \033[1m
ITALIC		= \033[3m
UNDERLINE	= \033[4m

# ============================================================================ #
#                                 VARIABLES                                    #
# ============================================================================ #

NAME		= ircserv
CXX			= c++
CXXFLAGS	= -Wall -Wextra -Werror -std=c++98
RM			= rm -f
RMDIR		= rm -rf

# ============================================================================ #
#                                 DIRECTORIES                                  #
# ============================================================================ #

SRCDIR		= srcs
OBJDIR		= objs
INCDIR		= includes

# ============================================================================ #
#                                   SOURCES                                    #
# ============================================================================ #

# Main
SRCS		= main.cpp

# Core classes
SRCS		+= User.cpp \
			   Channel.cpp \
			   Utils.cpp \
			   IrcReplies.cpp

# Server files
SRCS		+= server/Server.cpp \
			   server/handleUser.cpp \
			   server/Join.cpp \
			   server/Part.cpp \
			   server/Kick.cpp \
			   server/Topic.cpp \
			   server/Invite.cpp \
			   server/Mode.cpp \
			   server/message.cpp \
			   server/Replay.cpp \
			   server/DCC.cpp

# ============================================================================ #
#                                   OBJECTS                                    #
# ============================================================================ #

OBJS		= $(SRCS:%.cpp=$(OBJDIR)/%.o)
DEPS		= $(OBJS:.o=.d)

# ============================================================================ #
#                                ASCII ART                                     #
# ============================================================================ #

define IRC_LOGO
$(CYAN)
	โโโโโโโโโโ  โโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโ โโโ   โโโโโโโโโโโโโโโโโโ 
	โโโโโโโโโโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโโโโโโโโโ   โโโโโโโโโโโโโโโโโโโ
	โโโโโโโโโโโโโโ         โโโโโโโโโโโโโโ  โโโโโโโโโโโ   โโโโโโโโโ  โโโโโโโโ
	โโโโโโโโโโโโโโ         โโโโโโโโโโโโโโ  โโโโโโโโโโโโ โโโโโโโโโโ  โโโโโโโโ
	โโโโโโ  โโโโโโโโโโโ    โโโโโโโโโโโโโโโโโโโ  โโโ โโโโโโโ โโโโโโโโโโโ  โโโ
	โโโโโโ  โโโ โโโโโโโ    โโโโโโโโโโโโโโโโโโโ  โโโ  โโโโโ  โโโโโโโโโโโ  โโโ
$(DEF_COLOR)
endef
export IRC_LOGO

define CLEAN_MSG
$(YELLOW)
	โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
	โ                    ๐งน CLEANING OBJECTS                    โ
	โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
$(DEF_COLOR)
endef
export CLEAN_MSG

define FCLEAN_MSG
$(RED)
	โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
	โ                  ๐๏ธ  FULL CLEAN COMPLETE                  โ
	โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
$(DEF_COLOR)
endef
export FCLEAN_MSG

define SUCCESS_MSG
$(GREEN)
	โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
	โ              โจ COMPILATION SUCCESSFUL โจ                 โ
	โ                                                           โ
	โ              Ready to launch: ./$(NAME)                   โ
	โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
$(DEF_COLOR)
endef
export SUCCESS_MSG

# ============================================================================ #
#                                   RULES                                      #
# ============================================================================ #

all: $(NAME)

$(NAME): $(OBJS)
	@echo "$(BLUE)$(BOLD)โก Linking $(NAME)...$(DEF_COLOR)"
	@$(CXX) $(CXXFLAGS) $(OBJS) -o $(NAME)
	@echo "$$IRC_LOGO"
	@echo "$$SUCCESS_MSG"

$(OBJDIR)/%.o: $(SRCDIR)/%.cpp
	@mkdir -p $(dir $@)
	@echo "$(CYAN)๐ฆ Compiling: $(GRAY)$<$(DEF_COLOR)"
	@$(CXX) $(CXXFLAGS) -I$(INCDIR) -MMD -MP -c $< -o $@

-include $(DEPS)

clean:
	@echo "$$CLEAN_MSG"
	@$(RMDIR) $(OBJDIR)
	@echo "$(GREEN)โ Object files removed$(DEF_COLOR)"

fclean: clean
	@$(RM) $(NAME)
	@echo "$$FCLEAN_MSG"

re: fclean all

.PHONY: all clean fclean re

# ============================================================================ #
#                                INFO & HELP                                   #
# ============================================================================ #

info:
	@echo "$(CYAN)$(BOLD)"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo "โ                    IRC SERVER - PROJECT INFO                   โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ"
	@echo "โ $(WHITE)Name:$(CYAN)          $(NAME)                                         โ"
	@echo "โ $(WHITE)Compiler:$(CYAN)      $(CXX)                                             โ"
	@echo "โ $(WHITE)Flags:$(CYAN)         $(CXXFLAGS)                โ"
	@echo "โ $(WHITE)Sources:$(CYAN)       $(words $(SRCS)) files                                        โ"
	@echo "โ $(WHITE)Objects:$(CYAN)       $(words $(OBJS)) files                                        โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo "$(DEF_COLOR)"

help:
	@echo "$(MAGENTA)$(BOLD)"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo "โ                       MAKEFILE COMMANDS                        โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ"
	@echo "โ $(WHITE)make$(MAGENTA)          - Compile the project                            โ"
	@echo "โ $(WHITE)make clean$(MAGENTA)    - Remove object files                            โ"
	@echo "โ $(WHITE)make fclean$(MAGENTA)   - Remove all generated files                     โ"
	@echo "โ $(WHITE)make re$(MAGENTA)       - Rebuild the entire project                     โ"
	@echo "โ $(WHITE)make info$(MAGENTA)     - Display project information                    โ"
	@echo "โ $(WHITE)make help$(MAGENTA)     - Display this help message                      โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ"
	@echo "โ $(YELLOW)Usage:$(MAGENTA) ./$(NAME) <port> <password>                             โ"
	@echo "โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ"
	@echo "$(DEF_COLOR)"

.PHONY: info help
